#Jan 26 18:00:00 172.19.43.41 RTHAD01.ricoh.co.th	MSWinEventLog	1	Security	146459390	�. �.�. 26 17:59:59 2559	4769	Microsoft-Windows-Security-Auditing	RICOH.CO.TH\BSDSPSQLService@RICOH.CO.TH	N/A	Failure Audit	RTHAD01.ricoh.co.th	Kerberos Service Ticket Operations		A Kerberos service ticket was requested.    Account Information:   Account Name:  BSDSPSQLService@RICOH.CO.TH   Account Domain:  RICOH.CO.TH   Logon GUID:  {00000000-0000-0000-0000-000000000000}    Service Information:   Service Name:  BSDSPSQLService@RICOH.CO.TH   Service ID:  S-1-0-0    Network Information:   Client Address:  ::ffff:172.19.45.19   Client Port:  63004    Additional Information:   Ticket Options:  0x40810008   Ticket Encryption Type: 0xFFFFFFFF   Failure Code:  0x6   Transited Services: -    This event

#%{SYSLOGTIMESTAMP:log_timestamp} %{IPORHOST:source} %{IPORHOST:hostname}[\t]%{DATA:MSWinEventLog}[\t]%{INT:Criticality}[\t]%{DATA:EventLogSource}[\t]%{INT:SnareCounter}[\t].* %{DATA:SubmitDate} %{DATA:SubmitTime} %{DATA:SubmitYear}[\t]%{INT:EventID}[\t]Microsoft-Windows-Security-Auditing[\t]%{DATA:SourceName}[\t]%{DATA:UserName}[\t]%{DATA:EventLogType}[\t]%{DATA:ComputerName}[\t]Kerberos Service Ticket Operations[\t][\t]A Kerberos service ticket was requested.    Account Information:%{SPACE}%{DATA:AccountInfo}   Account Name:%{SPACE}%{DATA:AccountName}   Account Domain:%{SPACE}%{DATA:AccountDomain}   Logon GUID:%{SPACE}%{DATA:LogonGUID}    Service Information:%{SPACE}%{DATA:ServiceInfo}   Service Name:%{SPACE}%{DATA:ServiceName}   Service ID:%{SPACE}%{DATA:ServiceID}    Network Information:%{SPACE}%{DATA:NetworkInfo}   Client Address:%{SPACE}%{IP:ClientAddress}   Client Port:%{SPACE}%{INT:ClientPort}    Additional Information:%{SPACE}%{DATA:AdditionalInfo}   Ticket Options:%{SPACE}%{DATA:TicketOptions}   Ticket Encryption Type:%{SPACE}%{DATA:TicketEncrypType}   Failure Code:%{SPACE}%{DATA:FailureCode}   Transited Services:%{SPACE}%{DATA:TransitedServices}    This event.*

#Jan 26 12:00:00 172.19.43.41 RTHAD01.ricoh.co.th	MSWinEventLog	1	Security	138388407	�. �.�. 26 12:00:00 2559	4624	Microsoft-Windows-Security-Auditing	RICOH\ITD004	N/A	Success Audit	RTHAD01.ricoh.co.th	Logon		An account was successfully logged on.    Subject:   Security ID:  S-1-0-0   Account Name:  -   Account Domain:  -   Logon ID:  0x0    Logon Type:   3    Impersonation Level:  Impersonation    New Logon:   Security ID:  S-1-5-21-1733906783-1440912411-4199857830-10429   Account Name:  ITD004   Account Domain:  RICOH   Logon ID:  0x7D3F3DE6   Logon GUID:  {00000000-0000-0000-0000-000000000000}    Process Information:   Process ID:  0x0   Process Name:  -    Network Information:   Workstation Name: RTHINFO16   Source Network Address: -   Source Port:  -    Detailed Authentication Information:   Logon Process:  NtLmSsp    Authentication Package: NTLM   Transited Services: -   Package Name (NTLM only): NTLM V1   Key Length:  0    This event

#%{SYSLOGTIMESTAMP:log_timestamp} %{IPORHOST:source} %{IPORHOST:hostname}[\t]%{DATA:MSWinEventLog}[\t]%{INT:Criticality}[\t]%{DATA:EventLogSource}[\t]%{INT:SnareCounter}[\t].* %{DATA:SubmitDate} %{DATA:SubmitTime} %{DATA:SubmitYear}[\t]%{INT:EventID}[\t]Microsoft-Windows-Security-Auditing[\t]%{DATA:SourceName}[\t]%{DATA:UserName}[\t]%{DATA:EventLogType}[\t]%{DATA:ComputerName}[\t]%{DATA:Type}[\t][\t]An account was successfully logged on.%{SPACE}Subject:%{SPACE}%{DATA:Subject}   Security ID:%{SPACE}%{DATA:SecurityID}   Account Name:%{SPACE}%{DATA:AccountName}   Account Domain:%{SPACE}%{DATA:AccountDomain}   Logon ID:%{SPACE}%{DATA:LogonID}    Logon Type:%{SPACE}%{INT:LogonType}    Impersonation Level:%{SPACE}%{DATA:ImpersonationLevel}    New Logon:%{SPACE}%{DATA:NewLogon}   Security ID:%{SPACE}%{DATA:SecurityID2}   Account Name:%{SPACE}%{DATA:AccountName2}   Account Domain:%{SPACE}%{DATA:AccountDomain2}   Logon ID:%{SPACE}%{DATA:LogonID2}   Logon GUID:%{SPACE}%{DATA:LogonGUID}    Process Information:%{SPACE}%{DATA:ProcessInfo}   Process ID:%{SPACE}%{DATA:ProcessID}   Process Name:%{SPACE}%{DATA:ProcessName}    Network Information:%{SPACE}%{DATA:NetworkInfo}   Workstation Name:%{SPACE}%{DATA:WorkstationName}   Source Network Address:%{SPACE}%{DATA:SrcNetworkAddr}   Source Port:%{SPACE}%{DATA:SrcPort}    Detailed Authentication Information:%{SPACE}%{DATA:DetailedAuthInfo}   Logon Process:%{SPACE}%{DATA:LogonProcess}    Authentication Package:%{SPACE}%{DATA:AuthPackage}   Transited Services:%{SPACE}%{DATA:TransitedServices}   Package Name .*:%{SPACE}%{DATA:PackageName}   Key Length:%{SPACE}%{INT:KeyLength}    This event.*


#Jan 26 12:00:00 172.19.43.41 RTHAD01.ricoh.co.th	MSWinEventLog	1	Security	138388429	�. �.�. 26 12:00:00 2559	4634	Microsoft-Windows-Security-Auditing	RICOH\270001	N/A	Success Audit	RTHAD01.ricoh.co.th	Logoff		An account was logged off.    Subject:   Security ID:  S-1-5-21-1733906783-1440912411-4199857830-1375   Account Name:  270001   Account Domain:  RICOH   Logon ID:  0x7D3F3E6E    Logon Type:   3    This event

#%{SYSLOGTIMESTAMP:log_timestamp} %{IPORHOST:source} %{IPORHOST:hostname}[\t]%{DATA:MSWinEventLog}[\t]%{INT:Criticality}[\t]%{DATA:EventLogSource}[\t]%{INT:SnareCounter}[\t].* %{DATA:SubmitDate} %{DATA:SubmitTime} %{DATA:SubmitYear}[\t]%{INT:EventID}[\t]Microsoft-Windows-Security-Auditing[\t]%{DATA:SourceName}[\t]%{DATA:UserName}[\t]%{DATA:EventLogType}[\t]%{DATA:ComputerName}[\t]%{DATA:Type}[\t][\t]An account was logged off.%{SPACE}Subject:%{SPACE}%{DATA:Subject}   Security ID:%{SPACE}%{DATA:SecurityID}   Account Name:%{SPACE}%{DATA:AccountName}   Account Domain:%{SPACE}%{DATA:AccountDomain}   Logon ID:%{SPACE}%{DATA:LogonID}    Logon Type:%{SPACE}%{INT:LogonType}    This event.*

input {
    tcp {
        port => 5140
        codec => plain { charset => "US-ASCII" }
    }
}

filter {
	if [type_log] =~ "eventlog" {
        grok {
        	match => ["message", "%{SYSLOGTIMESTAMP:log_timestamp} %{IPORHOST:source} %{IPORHOST:hostname}[\t]%{DATA:MSWinEventLog}[\t]%{INT:Criticality}[\t]%{DATA:EventLogSource}[\t]%{INT:SnareCounter}[\t].* %{DATA:SubmitDate} %{DATA:SubmitTime} %{DATA:SubmitYear}[\t]%{INT:EventID}[\t]Microsoft-Windows-Security-Auditing[\t]%{DATA:SourceName}[\t]%{DATA:UserName}[\t]%{DATA:EventLogType}[\t]%{DATA:ComputerName}[\t]Kerberos Service Ticket Operations[\t][\t]A Kerberos service ticket was requested.    Account Information:%{SPACE}%{DATA:AccountInfo}   Account Name:%{SPACE}%{DATA:AccountName}   Account Domain:%{SPACE}%{DATA:AccountDomain}   Logon GUID:%{SPACE}%{DATA:LogonGUID}    Service Information:%{SPACE}%{DATA:ServiceInfo}   Service Name:%{SPACE}%{DATA:ServiceName}   Service ID:%{SPACE}%{DATA:ServiceID}    Network Information:%{SPACE}%{DATA:NetworkInfo}   Client Address:%{SPACE}%{IP:ClientAddress}   Client Port:%{SPACE}%{INT:ClientPort}    Additional Information:%{SPACE}%{DATA:AdditionalInfo}   Ticket Options:%{SPACE}%{DATA:TicketOptions}   Ticket Encryption Type:%{SPACE}%{DATA:TicketEncrypType}   Failure Code:%{SPACE}%{DATA:FailureCode}   Transited Services:%{SPACE}%{DATA:TransitedServices}    This event.*",
        	"message", "%{SYSLOGTIMESTAMP:log_timestamp} %{IPORHOST:source} %{IPORHOST:hostname}[\t]%{DATA:MSWinEventLog}[\t]%{INT:Criticality}[\t]%{DATA:EventLogSource}[\t]%{INT:SnareCounter}[\t].* %{DATA:SubmitDate} %{DATA:SubmitTime} %{DATA:SubmitYear}[\t]%{INT:EventID}[\t]Microsoft-Windows-Security-Auditing[\t]%{DATA:SourceName}[\t]%{DATA:UserName}[\t]%{DATA:EventLogType}[\t]%{DATA:ComputerName}[\t]%{DATA:Type}[\t][\t]An account was successfully logged on.%{SPACE}Subject:%{SPACE}%{DATA:Subject}   Security ID:%{SPACE}%{DATA:SecurityID}   Account Name:%{SPACE}%{DATA:AccountName}   Account Domain:%{SPACE}%{DATA:AccountDomain}   Logon ID:%{SPACE}%{DATA:LogonID}    Logon Type:%{SPACE}%{INT:LogonType}    Impersonation Level:%{SPACE}%{DATA:ImpersonationLevel}    New Logon:%{SPACE}%{DATA:NewLogon}   Security ID:%{SPACE}%{DATA:SecurityID2}   Account Name:%{SPACE}%{DATA:AccountName2}   Account Domain:%{SPACE}%{DATA:AccountDomain2}   Logon ID:%{SPACE}%{DATA:LogonID2}   Logon GUID:%{SPACE}%{DATA:LogonGUID}    Process Information:%{SPACE}%{DATA:ProcessInfo}   Process ID:%{SPACE}%{DATA:ProcessID}   Process Name:%{SPACE}%{DATA:ProcessName}    Network Information:%{SPACE}%{DATA:NetworkInfo}   Workstation Name:%{SPACE}%{DATA:WorkstationName}   Source Network Address:%{SPACE}%{DATA:SrcNetworkAddr}   Source Port:%{SPACE}%{DATA:SrcPort}    Detailed Authentication Information:%{SPACE}%{DATA:DetailedAuthInfo}   Logon Process:%{SPACE}%{DATA:LogonProcess}    Authentication Package:%{SPACE}%{DATA:AuthPackage}   Transited Services:%{SPACE}%{DATA:TransitedServices}   Package Name .*:%{SPACE}%{DATA:PackageName}   Key Length:%{SPACE}%{INT:KeyLength}    This event.*",
        	"message", "%{SYSLOGTIMESTAMP:log_timestamp} %{IPORHOST:source} %{IPORHOST:hostname}[\t]%{DATA:MSWinEventLog}[\t]%{INT:Criticality}[\t]%{DATA:EventLogSource}[\t]%{INT:SnareCounter}[\t].* %{DATA:SubmitDate} %{DATA:SubmitTime} %{DATA:SubmitYear}[\t]%{INT:EventID}[\t]Microsoft-Windows-Security-Auditing[\t]%{DATA:SourceName}[\t]%{DATA:UserName}[\t]%{DATA:EventLogType}[\t]%{DATA:ComputerName}[\t]%{DATA:Type}[\t][\t]An account was logged off.%{SPACE}Subject:%{SPACE}%{DATA:Subject}   Security ID:%{SPACE}%{DATA:SecurityID}   Account Name:%{SPACE}%{DATA:AccountName}   Account Domain:%{SPACE}%{DATA:AccountDomain}   Logon ID:%{SPACE}%{DATA:LogonID}    Logon Type:%{SPACE}%{INT:LogonType}    This event.*"
        	]
    	}
    }
}

output {
	if ("_grokparsefailure" in [tags]) {
    	stdout { codec => rubydebug { metadata => true } }
    }
}